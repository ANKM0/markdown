# 4章_学習メモ

## insert文

- 文法的は insert into テーブル (値)
- 他のテーブルから値を持ってくるとき insert into テーブル select * from テーブル2
- select * from テーブル2は任意のSQLを実行可能

## delete文

- テーブルの構造はそのままに内容を削除する。
- 文法は delete from テーブル
- 一部のみ削除する場合は delete from テーブル where 条件

## update文

- 文法は　update テーブル set 列=値 where 条件
- 複数行の時は update テーブル set (列,列2) = (値1, 値2) where 条件

## トランザクション

- ワンセットで行う必要がある処理(複数)をまとめて実行する

### 構文

```SQL
/*
トランザクション開始文;

DML文1
DML文2
DML文3
...

トランザクション終了文(commit or rollback)
*/
```

- トランザクション開始文はDBによって変わる
- commit → 　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　b　　　　　　　　　　　　　　　　処理を実行
- rollback → 処理を中断(処理前の状態に戻る)

## ACID特性

SQL標準規格で定められたDBMSのトランザクションが守るべき4つの約束事。

### 原始性(Atomicity)

- オールorナッシング
- トランザクション内の処理が全て実行されるor実行されない状態にならないこと

### 一貫性(Consistency)

- テーブル定義に違反するSQLを実行しないこと(ex...not nullの列にnullとか)
- 一文単位で処理が取り消される。

### 独立性(isolation)

- 他のトランザクションから干渉を受けないこと→トランザクションの入れ子は存在しない。
- 変更をcommitするまで、追加したレコードを他に見せない

### 永続性(Durability)

- トランザクション終了時の状態を何らかの手段で復旧できるようにすること。
- 通常は、トランザクション実行記録をログに保存して対応する。
